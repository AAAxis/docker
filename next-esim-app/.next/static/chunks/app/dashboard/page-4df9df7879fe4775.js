(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{63:(e,s,t)=>{"use strict";var a=t(7260);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},508:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},686:(e,s,t)=>{"use strict";t.d(s,{Cn:()=>m,db:()=>x,j2:()=>o});var a=t(2078),l=t(1328),r=t(9708),i=t(9996),c=t(6849),n=t(4663);let d=(0,a.Wp)({apiKey:"AIzaSyAl456JTQntXJItbXSv8hx1oQ9KW4BGci4",authDomain:"esim-f0e3e.firebaseapp.com",projectId:"esim-f0e3e",storageBucket:"esim-f0e3e.firebasestorage.app",messagingSenderId:"482450515497",appId:"1:482450515497:web:08533fb9536c8e6aa39e38",measurementId:"G-T0YBW024Z8"}),o=(0,l.xI)(d),x=(0,r.aU)(d);(0,i.c7)(d);let m=(0,c.Uz)(d);(0,n.TT)().then(e=>{e?((0,n.P5)(d),console.log("✅ Firebase Analytics initialized")):console.log("⚠️ Firebase Analytics not supported in this environment")}).catch(e=>{console.log("⚠️ Firebase Analytics initialization failed:",e)})},906:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},5870:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6809:(e,s,t)=>{"use strict";t.d(s,{A:()=>d,O:()=>o});var a=t(5155),l=t(2115),r=t(1328),i=t(9708),c=t(686);let n=(0,l.createContext)();function d(){return(0,l.useContext)(n)}function o(e){let{children:s}=e,[t,d]=(0,l.useState)(null),[o,x]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null);async function h(e,s,t){try{let{user:a}=await (0,r.eJ)(c.j2,e,s);return await (0,r.r7)(a,{displayName:t}),await (0,i.BN)((0,i.doc)(c.db,"users",a.uid),{email:a.email,displayName:t,createdAt:new Date,role:"customer",wallet:{balance:0,currency:"USD"}}),a}catch(e){throw e}}async function y(e,s){try{let{user:t}=await (0,r.x9)(c.j2,e,s);return t}catch(e){throw e}}async function p(){try{await (0,r.CI)(c.j2)}catch(e){throw e}}async function g(e){try{await (0,r.J1)(c.j2,e)}catch(e){throw e}}async function j(e){try{t&&(await (0,i.BN)((0,i.doc)(c.db,"users",t.uid),e,{merge:!0}),u(s=>({...s,...e})))}catch(e){throw e}}async function b(){if(t)try{let e=await (0,i.getDoc)((0,i.doc)(c.db,"users",t.uid));e.exists()&&u(e.data())}catch(e){console.error("Error loading user profile:",e)}}return(0,l.useEffect)(()=>(0,r.hg)(c.j2,async e=>{d(e),e?await b():u(null),x(!1)}),[]),(0,a.jsx)(n.Provider,{value:{currentUser:t,userProfile:m,signup:h,login:y,logout:p,resetPassword:g,updateUserProfile:j,loadUserProfile:b},children:!o&&s})}},7065:(e,s,t)=>{"use strict";t.d(s,{default:()=>y});var a=t(5155),l=t(2115),r=t(6809),i=t(9708),c=t(686),n=t(4486),d=t(508),o=t(9068),x=t(906),m=t(8519),u=t(5870),h=t(63);let y=()=>{var e;let{currentUser:s,userProfile:t,loadUserProfile:y}=(0,r.A)(),[p,g]=(0,l.useState)([]),[j,b]=(0,l.useState)(!0),f=(0,h.useRouter)();if((0,l.useEffect)(()=>{let e=async()=>{if(s)try{let e=(0,i.P)((0,i.collection)(c.db,"orders"),(0,i._M)("customerEmail","==",s.email)),t=(await (0,i.GG)(e)).docs.map(e=>({id:e.id,...e.data()}));g(t)}catch(e){console.error("Error fetching orders:",e)}finally{b(!1)}};(async()=>{if(s)try{console.log("Checking user profile for:",s.uid);let e=await (0,i.getDoc)((0,i.doc)(c.db,"users",s.uid));e.exists()?console.log("✅ User profile exists:",e.data()):(console.log("User profile does not exist, creating..."),await (0,i.BN)((0,i.doc)(c.db,"users",s.uid),{email:s.email,displayName:s.displayName||"Unknown User",createdAt:new Date,role:"customer",wallet:{balance:0,currency:"USD"}}),console.log("✅ Created missing user profile")),await y()}catch(e){console.error("❌ Error ensuring user profile:",e)}})(),e()},[s,y]),!s)return f.push("/login"),null;let N=p.filter(e=>"active"===e.status);return p.filter(e=>"pending"===e.status),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(d.A,{className:"w-8 h-8 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",s.displayName||s.email,"!"]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your eSIM orders and account settings"})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:p.length})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(o.A,{className:"w-6 h-6 text-blue-600"})})]})}),(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active eSIMs"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:N.length})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:(0,a.jsx)(x.A,{className:"w-6 h-6 text-green-600"})})]})}),(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3},className:"bg-white rounded-xl shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Wallet Balance"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:["$",(null==t||null==(e=t.wallet)?void 0:e.balance)||0]})]}),(0,a.jsx)("div",{className:"bg-purple-100 p-3 rounded-full",children:(0,a.jsx)(m.A,{className:"w-6 h-6 text-purple-600"})})]})})]}),(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Orders"}),(0,a.jsx)("button",{onClick:()=>f.push("/plans"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Buy New eSIM"})]}),j?(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===p.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(o.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No orders yet"}),(0,a.jsx)("button",{onClick:()=>f.push("/plans"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Browse Plans"})]}):(0,a.jsx)("div",{className:"space-y-4",children:p.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("active"===e.status?"bg-green-500":"pending"===e.status?"bg-yellow-500":"bg-gray-500")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.planName}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Order #",e.orderId]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium text-gray-900",children:["$",Math.round(e.amount)]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 capitalize",children:e.status})]})]},e.id))})]}),(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,a.jsx)(u.A,{className:"w-6 h-6 text-gray-600"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Account Settings"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:s.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:s.displayName||"Not set"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Account Created"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:(null==t?void 0:t.createdAt)?new Date(t.createdAt.toDate()).toLocaleDateString():"Unknown"}),!(null==t?void 0:t.createdAt)&&(0,a.jsx)("button",{onClick:async()=>{console.log("Manual refresh triggered"),await y()},className:"mt-2 text-sm text-blue-600 hover:text-blue-800 underline",children:"Refresh Profile"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900 capitalize",children:(null==t?void 0:t.role)||"customer"})]})]})]})]})]})})}},8221:(e,s,t)=>{Promise.resolve().then(t.bind(t,7065))},8519:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},9068:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])}},e=>{e.O(0,[135,210,584,416,441,255,358],()=>e(e.s=8221)),_N_E=e.O()}]);