(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{686:(e,a,t)=>{"use strict";t.d(a,{Cn:()=>x,db:()=>m,j2:()=>d});var r=t(2078),s=t(1328),n=t(9708),l=t(9996),o=t(6849),i=t(4663);let c=(0,r.Wp)({apiKey:"AIzaSyAl456JTQntXJItbXSv8hx1oQ9KW4BGci4",authDomain:"esim-f0e3e.firebaseapp.com",projectId:"esim-f0e3e",storageBucket:"esim-f0e3e.firebasestorage.app",messagingSenderId:"482450515497",appId:"1:482450515497:web:08533fb9536c8e6aa39e38",measurementId:"G-T0YBW024Z8"}),d=(0,s.xI)(c),m=(0,n.aU)(c);(0,l.c7)(c);let x=(0,o.Uz)(c);(0,i.TT)().then(e=>{e?((0,i.P5)(c),console.log("✅ Firebase Analytics initialized")):console.log("⚠️ Firebase Analytics not supported in this environment")}).catch(e=>{console.log("⚠️ Firebase Analytics initialization failed:",e)})},4156:(e,a,t)=>{"use strict";t.d(a,{default:()=>U});var r=t(5155),s=t(2115),n=t(6809),l=t(5869),o=t(9708),i=t(6849),c=t(686),d=t(1408),m=t(4486),x=t(9068),u=t(1873),g=t(5870),h=t(906),p=t(1524),y=t(1169),b=t(4347),f=t(1761),j=t(5710),N=t(532),v=t(7828),w=t(9559),A=t(9867),P=t(2056),C=t(1360),S=t(6651),E=t(6191),D=t(1010),k=t(2663);let _=e=>e&&2===e.length?String.fromCodePoint(...e.toUpperCase().split("").map(e=>127397+e.charCodeAt())):null,U=()=>{let{currentUser:e}=(0,n.A)(),{isAdmin:a,userRole:t,canManageCountries:U,canManagePlans:I,canManageConfig:M,canDeleteData:R,canManageAdmins:G,loading:F}=(0,l.z8)(),[L,T]=(0,s.useState)("overview"),[O,B]=(0,s.useState)("test"),[z,W]=(0,s.useState)("test"),[$,V]=(0,s.useState)(""),[Z,J]=(0,s.useState)(!1),[Y,H]=(0,s.useState)(!1),[K,Q]=(0,s.useState)(!1),[X,q]=(0,s.useState)("Ready to sync data from DataPlans API"),[ee,ea]=(0,s.useState)([]),[et,er]=(0,s.useState)([]),[es,en]=(0,s.useState)(""),[el,eo]=(0,s.useState)([]),[ei,ec]=(0,s.useState)(!1),[ed,em]=(0,s.useState)(null),[ex,eu]=(0,s.useState)([]),[eg,eh]=(0,s.useState)([]),[ep,ey]=(0,s.useState)(!1),[eb,ef]=(0,s.useState)(null),[ej,eN]=(0,s.useState)([]),[ev,ew]=(0,s.useState)(!1),[eA,eP]=(0,s.useState)(!1),[eC,eS]=(0,s.useState)(!1),[eE,eD]=(0,s.useState)([]),[ek,e_]=(0,s.useState)(null),[eU,eI]=(0,s.useState)({name:"",code:"",description:"",countries:[],minPrice:0,icon:"\uD83C\uDF0D"}),[eM,eR]=(0,s.useState)([]),[eG,eF]=(0,s.useState)([]),[eL,eT]=(0,s.useState)(""),[eO,eB]=(0,s.useState)(!1),[ez,eW]=(0,s.useState)(null),[e$,eV]=(0,s.useState)(!1),[eZ,eJ]=(0,s.useState)([]),[eY,eH]=(0,s.useState)("");if((0,s.useEffect)(()=>{e&&(eK(),e1(),e3(),eQ(),as())},[e]),(0,s.useEffect)(()=>{er(ee.filter(e=>{var a,t;return(null==(a=e.name)?void 0:a.toLowerCase().includes(es.toLowerCase()))||(null==(t=e.code)?void 0:t.toLowerCase().includes(es.toLowerCase()))}))},[ee,es]),(0,s.useEffect)(()=>{eF(eM.filter(e=>{var a,t,r;return(null==(a=e.email)?void 0:a.toLowerCase().includes(eL.toLowerCase()))||(null==(t=e.role)?void 0:t.toLowerCase().includes(eL.toLowerCase()))||(null==(r=e.id)?void 0:r.toLowerCase().includes(eL.toLowerCase()))}))},[eM,eL]),(0,s.useEffect)(()=>{let e=e=>{eA&&!e.target.closest(".dropdown-container")&&eP(!1),eC&&!e.target.closest(".dropdown-container")&&eS(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[eA,eC]),!e)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Please log in"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You need to be logged in to access the admin dashboard"})]})});let eK=async()=>{try{try{(0,o.doc)(c.db,"config","environment");let e=await (0,o.GG)((0,o.P)((0,o.collection)(c.db,"config"),(0,o._M)("__name__","==","environment")));if(!e.empty){let a=e.docs[0].data();a.mode&&(B(a.mode),console.log("✅ Environment loaded from Firestore:",a.mode))}}catch(e){console.log("⚠️ Could not load environment from Firestore, using localStorage")}let e=localStorage.getItem("esim_environment"),a=localStorage.getItem("esim_stripe_mode");e&&B(e),a&&W(a)}catch(e){console.error("Error loading saved config:",e)}},eQ=async()=>{try{try{(0,o.doc)(c.db,"config","dataplans");let e=await (0,o.GG)((0,o.P)((0,o.collection)(c.db,"config"),(0,o._M)("__name__","==","dataplans")));if(!e.empty){let a=e.docs[0].data();if(a.api_key){V(a.api_key),console.log("✅ DataPlans API key loaded from Firestore");return}}}catch(e){console.log("⚠️ Could not load API key from Firestore, trying localStorage")}let e=localStorage.getItem("dataplans_api_key");e&&(V(e),console.log("✅ DataPlans API key loaded from localStorage"))}catch(e){console.error("Error loading API key:",e)}},eX=async()=>{try{if(!$.trim())return void k.Ay.error("Please enter a valid API key");localStorage.setItem("dataplans_api_key",$);let a=(0,o.doc)(c.db,"config","dataplans");await (0,o.mZ)(a,{api_key:$,updated_at:new Date,updated_by:(null==e?void 0:e.uid)||"admin"},{merge:!0}),k.Ay.success("DataPlans API key saved successfully!"),console.log("✅ DataPlans API key saved to localStorage and Firestore")}catch(e){console.error("Error saving API key:",e),k.Ay.error("Error saving API key: ".concat(e.message))}},eq=async()=>{let a="test"===O?"production":"test";B(a),localStorage.setItem("esim_environment",a);try{let t=(0,o.doc)(c.db,"config","environment");await (0,o.mZ)(t,{mode:a,updated_at:new Date,updated_by:(null==e?void 0:e.uid)||"admin"},{merge:!0}),console.log("✅ Environment saved to Firestore:",a)}catch(e){console.error("⚠️ Could not save environment to Firestore:",e)}k.Ay.success("Environment switched to ".concat(a))},e0=async()=>{let e="test"===z?"production":"test";W(e),localStorage.setItem("esim_stripe_mode",e),k.Ay.success("Stripe mode switched to ".concat(e))},e1=async()=>{try{H(!0);let e=(await (0,o.GG)((0,o.collection)(c.db,"countries"))).docs.map(e=>{let a=e.data();return{id:e.id,...a,flagEmoji:a.flagEmoji||_(a.code)}});console.log("\uD83D\uDD04 Loading plans to calculate country minPrice...");let a=(await (0,o.GG)((0,o.collection)(c.db,"plans"))).docs.map(e=>({id:e.id,...e.data()})),t=e.map(e=>{let t=a.filter(a=>{let t=a.country_codes&&a.country_codes.includes(e.code),r=a.country_ids&&a.country_ids.includes(e.code);return t||r});if(!(t.length>0))return{...e,minPrice:null,planCount:0,hasPlans:!1};{let a=Math.min(...t.map(e=>e.price||0)),r=t.length;return console.log("\uD83D\uDCCA ".concat(e.name,": ").concat(r," plans, minPrice: $").concat(a)),{...e,minPrice:Math.round(a),planCount:r,hasPlans:!0}}});ea(t),er(t),console.log("✅ Loaded",t.length,"countries with plan counts from Firestore")}catch(e){console.error("❌ Error loading countries:",e),k.Ay.error("Error loading countries: ".concat(e.message))}finally{H(!1)}},e2=async()=>{try{if(H(!0),!$.trim())return void k.Ay.error("Please configure DataPlans API key first");q("Fetching raw data from DataPlans API..."),console.log("\uD83D\uDD04 Getting raw plans from DataPlans API...");let e=(0,i.Qg)(c.Cn,"fetch_plans"),a=await e();if(a.data.success){console.log("\uD83D\uDD0D API response:",a.data);let e=a.data.countries||[],t=a.data.plans||[];console.log("✅ Got ".concat(e.length," countries and ").concat(t.length," plans")),console.log("\uD83D\uDD0D First plan:",t[0]),q("Converting prices and saving to Firebase...");let r=(0,o.wP)(c.db);e.forEach(e=>{if(e.countryCode&&e.countryName){let a=(0,o.doc)(c.db,"countries",e.countryCode);r.set(a,{name:e.countryName,code:e.countryCode,status:"active",updated_at:new Date,synced_at:new Date().toISOString()},{merge:!0})}}),t.forEach(e=>{if(e.slug&&e.name){let a=e.retailPrice||e.price||"0",t=e.priceCurrency||e.currency||"USD",s=parseFloat(a)||0,n="USD"===t?s:((e,a)=>{let t={CNY:.14,THB:.028,EUR:1.08,GBP:1.27,JPY:.0067,USD:1}[a.toUpperCase()]||1;return parseFloat(e)*t})(s,t);console.log("\uD83D\uDCB0 Plan: ".concat(e.name," - ").concat(a," ").concat(t," → $").concat(n.toFixed(2)," USD"));let l=(0,o.doc)(c.db,"plans",e.slug),i=(e.countries||[]).map(e=>e.countryCode||e.code||e).filter(Boolean);r.set(l,{slug:e.slug,name:e.name,description:e.description||"",price:n,currency:"USD",originalPrice:s,originalCurrency:t,capacity:-1===e.capacity?"Unlimited":e.capacity||0,period:e.period||0,country_codes:i,operator:e.operator||"",status:"active",updated_at:new Date,synced_at:new Date().toISOString()},{merge:!0})}}),await r.commit(),console.log("✅ Successfully saved all data to Firebase"),k.Ay.success("Successfully synced ".concat(e.length," countries and ").concat(t.length," plans")),q("Successfully synced ".concat(e.length+t.length," items from DataPlans API")),await e1(),await at()}else throw Error(a.data.error||"Unknown error occurred")}catch(e){console.error("❌ Error syncing data:",e),k.Ay.error("Error syncing data: ".concat(e.message)),q("Error syncing data: ".concat(e.message))}finally{H(!1)}},e6=async e=>{if(window.confirm("Delete ".concat(e,"? This will also delete all associated plans.")))try{H(!0);let a=(0,o.P)((0,o.collection)(c.db,"countries"),(0,o._M)("code","==",e)),t=await (0,o.GG)(a),r=(0,o.wP)(c.db);t.forEach(e=>r.delete(e.ref)),await r.commit(),k.Ay.success("".concat(e," deleted successfully!")),await e1()}catch(a){console.error("❌ Error deleting country:",a),k.Ay.error("Error deleting ".concat(e,": ").concat(a.message))}finally{H(!1)}},e5=async(e,a)=>{try{H(!0);let t=(0,o.P)((0,o.collection)(c.db,"plans"),(0,o._M)("country_codes","array-contains",e)),r=(0,o.P)((0,o.collection)(c.db,"plans"),(0,o._M)("status","==","active"),(0,o._M)("country_ids","array-contains",e)),[s,n]=await Promise.all([(0,o.GG)(t),(0,o.GG)(r)]),l=new Map;s.docs.forEach(e=>{let a=e.data();l.set(e.id,{id:e.id,...a,source:"mobile",data:a.capacity||a.data||"N/A",duration:a.period||a.duration||"N/A"})}),n.docs.forEach(e=>{let a=e.data();l.set(e.id,{id:e.id,...a,source:"web",data:a.data||a.capacity||"N/A",duration:a.duration||a.period||"N/A"})});let i=Array.from(l.values());console.log("\uD83D\uDCF1\uD83D\uDCCA Combined plans for",a,":",i),eJ(i),eH(a),e_({code:e,name:a}),eV(!0),await ao()}catch(e){console.error("❌ Error loading country plans:",e),k.Ay.error("Error loading plans for ".concat(a,": ").concat(e.message))}finally{H(!1)}},e4=async()=>{if(window.confirm("Delete ALL countries? This will remove all countries and their plans from the database. DataPlans can then fetch fresh data."))try{Q(!0),console.log("\uD83D\uDDD1️ Starting deletion of all countries...");let e=await (0,o.GG)((0,o.collection)(c.db,"countries"));console.log("Found ".concat(e.docs.length," countries to delete"));let a=await (0,o.GG)((0,o.collection)(c.db,"plans"));console.log("Found ".concat(a.docs.length," plans to delete"));let t=(0,o.wP)(c.db);e.forEach(e=>{t.delete(e.ref)}),a.forEach(e=>{t.delete(e.ref)}),await t.commit(),ea([]),er([]),k.Ay.success("Successfully deleted ".concat(e.docs.length," countries and ").concat(a.docs.length," plans!")),console.log("✅ All countries and plans deleted successfully")}catch(e){console.error("❌ Error deleting all countries:",e),k.Ay.error("Error deleting countries: ".concat(e.message))}finally{Q(!1)}},e3=async()=>{try{H(!0);let e=(await (0,o.GG)((0,o.collection)(c.db,"regions"))).docs.map(e=>({id:e.id,...e.data()}));eu(e),eh(e),console.log("✅ Loaded",e.length,"regions from Firestore")}catch(e){console.error("❌ Error loading regions:",e),k.Ay.error("Error loading regions: ".concat(e.message))}finally{H(!1)}},e8=async()=>{if(!eU.name||!eU.code)return void k.Ay.error("Please fill in all required fields");try{H(!0),await (0,o.gS)((0,o.collection)(c.db,"regions"),{...eU,createdAt:new Date,updatedAt:new Date}),k.Ay.success("Region created successfully!"),ew(!1),eI({name:"",code:"",description:"",countries:[],minPrice:0,icon:"\uD83C\uDF0D"}),await e3()}catch(e){console.error("❌ Error creating region:",e),k.Ay.error("Error creating region: ".concat(e.message))}finally{H(!1)}},e9=async(e,a)=>{if(window.confirm("Delete ".concat(a," region? This action cannot be undone.")))try{H(!0),await (0,o.kd)((0,o.doc)(c.db,"regions",e)),k.Ay.success("".concat(a," region deleted successfully!")),await e3()}catch(e){console.error("❌ Error deleting region:",e),k.Ay.error("Error deleting region: ".concat(e.message))}finally{H(!1)}},e7=async(e,a)=>{try{H(!0);let t=(await (0,o.GG)((0,o.P)((0,o.collection)(c.db,"regionalPlans"),(0,o._M)("regionId","==",e)))).docs.map(e=>({id:e.id,...e.data()}));eN(t),ef({id:e,name:a}),ey(!0)}catch(e){console.error("❌ Error fetching regional plans:",e),k.Ay.error("Error fetching plans for ".concat(a,": ").concat(e.message))}finally{H(!1)}},ae=async(e,a)=>{console.log("\uD83D\uDDD1️ deleteCountryPlan called with:",{planId:e,planName:a});try{H(!0),console.log("\uD83D\uDDD1️ Deleting document from Firestore:",e),await (0,o.kd)((0,o.doc)(c.db,"plans",e)),console.log("✅ Document deleted successfully"),k.Ay.success("".concat(a," plan detached successfully!")),e$&&ek?(console.log("\uD83D\uDD04 Refreshing country plans after delete for:",ek.code),await e5(ek.code,ek.name)):console.log("⚠️ Cannot refresh after delete: showCountriesModal:",e$,"selectedCountryForAttach:",ek),await e1()}catch(e){console.error("❌ Error deleting country plan:",e),k.Ay.error("Error detaching plan: ".concat(e.message))}finally{H(!1)}},aa=async(e,a)=>{console.log("\uD83D\uDD27 updateCountryPlanPrice called with:",{planId:e,newPrice:a});try{H(!0),console.log("\uD83D\uDD27 Updating plan price:",{planId:e,newPrice:a,selectedCountryForAttach:ek}),console.log("\uD83D\uDD27 Updating document in Firestore:",e),await (0,o.mZ)((0,o.doc)(c.db,"plans",e),{price:Math.round(a),updatedAt:new Date,priceUpdatedVia:"admin_panel"}),console.log("✅ Document updated successfully"),k.Ay.success("Plan price updated successfully!"),e$&&ek?(console.log("\uD83D\uDD04 Refreshing country plans for:",ek.code),await e5(ek.code,ek.name)):console.log("⚠️ Cannot refresh: showCountriesModal:",e$,"selectedCountryForAttach:",ek),await e1()}catch(e){console.error("❌ Error updating plan price:",e),k.Ay.error("Error updating price: ".concat(e.message))}finally{H(!1)}},at=async()=>{try{H(!0),console.log("\uD83D\uDCF1 Loading plans from Firebase...");let e=(await (0,o.GG)((0,o.collection)(c.db,"plans"))).docs.map(e=>({id:e.id,...e.data()}));if(e.length>0){let a=e.map(e=>{var a;return{id:e.slug||e.id,name:e.name,data:"Unlimited"===e.capacity||-1===e.capacity?"Unlimited GB":e.capacity?"".concat(e.capacity," GB"):"N/A",duration:e.period?"".concat(e.period," days"):"N/A",price:e.price||0,currency:e.currency||"USD",country:(null==(a=e.country_codes)?void 0:a[0])||"Multiple Countries",description:e.description||"",capacity:-1===e.capacity?"Unlimited":e.capacity,period:e.period,operator:e.operator||"",country_codes:e.country_codes||[]}}),t=ej.map(e=>e.originalPlanId),r=a.filter(e=>!t.includes(e.id));eD(r),r.length>0&&(console.log("\uD83D\uDD0D First plan data:",r[0]),console.log("\uD83D\uDD0D All plans price data:",r.map(e=>({name:e.name,price:e.price,currency:e.currency}))))}else eD([]),(0,k.Ay)('No plans found in Firebase. Click "Sync All Data from DataPlans" to load plans.',{icon:"ℹ️"})}catch(e){console.error("❌ Error loading plans from Firebase:",e),k.Ay.error("Error loading plans: ".concat(e.message))}finally{H(!1)}},ar=async e=>{if(!eb)return void k.Ay.error("No region selected");try{H(!0),await (0,o.gS)((0,o.collection)(c.db,"regionalPlans"),{name:e.name,data:e.data,duration:e.duration,price:e.price,currency:e.currency||"USD",description:e.description||"",regionId:eb.id,regionName:eb.name,originalPlanId:e.id,originalCountry:e.country,attachedAt:new Date,attachedVia:"admin_panel"}),k.Ay.success('Plan "'.concat(e.name,'" attached to ').concat(eb.name,"!")),eP(!1),ep&&eb&&await e7(eb.id,eb.name)}catch(e){console.error("❌ Error attaching plan:",e),k.Ay.error("Error attaching plan: ".concat(e.message))}finally{H(!1)}},as=async()=>{try{H(!0);let e=(await (0,o.GG)((0,o.collection)(c.db,"users"))).docs.map(e=>({id:e.id,...e.data()}));eR(e),eF(e),console.log("✅ Loaded",e.length,"users from Firestore")}catch(e){console.error("❌ Error loading users:",e),k.Ay.error("Error loading users: ".concat(e.message))}finally{H(!1)}},an=async(a,t)=>{if(window.confirm("Remove admin privileges from ".concat(t,"? This user will lose access to admin features.")))try{H(!0),await (0,o.mZ)((0,o.doc)(c.db,"users",a),{role:"user",adminRemovedAt:new Date,adminRemovedBy:e.email,updatedAt:new Date}),k.Ay.success("Admin privileges removed from ".concat(t)),await as(),eB(!1),eW(null)}catch(e){console.error("❌ Error removing admin privileges:",e),k.Ay.error("Error removing admin privileges: ".concat(e.message))}finally{H(!1)}},al=async(e,a)=>{if(window.confirm("Delete user ".concat(a,"? This action cannot be undone and will remove all user data.")))try{H(!0),await (0,o.kd)((0,o.doc)(c.db,"users",e)),k.Ay.success("User ".concat(a," deleted successfully")),await as()}catch(e){console.error("❌ Error deleting user:",e),k.Ay.error("Error deleting user: ".concat(e.message))}finally{H(!1)}},ao=async()=>{try{H(!0),console.log("\uD83D\uDCF1 Loading plans from Firebase...");let e=(await (0,o.GG)((0,o.collection)(c.db,"plans"))).docs.map(e=>({id:e.id,...e.data()}));if(e.length>0){let a=e.map(e=>{var a,t;let r=e.capacity||e.data,s=e.period||e.duration;return{id:e.slug||e.id,name:e.name,data:"Unlimited"===r||-1===r?"Unlimited GB":r?"".concat(r," GB"):"N/A",duration:s?"".concat(s," days"):"N/A",price:e.price||0,currency:e.currency||"USD",country:(null==(a=e.country_codes)?void 0:a[0])||(null==(t=e.country_ids)?void 0:t[0])||"Multiple Countries",description:e.description||"",capacity:-1===e.capacity?"Unlimited":e.capacity,period:e.period,operator:e.operator||"",country_codes:e.country_codes||e.country_ids||[]}}),t=a;if(ek){let e=eZ.map(e=>e.originalPlanId||e.id);t=a.filter(a=>!e.includes(a.id))}eD(t),t.length>0&&(console.log("\uD83D\uDD0D First plan data:",t[0]),console.log("\uD83D\uDD0D All plans price data:",t.map(e=>({name:e.name,price:e.price,currency:e.currency}))))}else eD([]),(0,k.Ay)('No plans found in Firebase. Click "Sync All Data from DataPlans" to load plans.',{icon:"ℹ️"})}catch(e){console.error("❌ Error loading plans from Firebase:",e),k.Ay.error("Error loading plans: ".concat(e.message))}finally{H(!1)}},ai=async e=>{if(!ek)return void k.Ay.error("No country selected");try{H(!0);let a=(0,o.P)((0,o.collection)(c.db,"plans"),(0,o._M)("name","==",e.name),(0,o._M)("country_codes","array-contains",ek.code));if(!(await (0,o.GG)(a)).empty)return void k.Ay.error('Plan "'.concat(e.name,'" is already available for ').concat(ek.name));let t={name:e.name,data:e.capacity||e.data||"N/A",duration:e.period||e.duration||"N/A",price:Math.round(e.price),currency:e.currency||"USD",description:e.description||"",country:ek.name,countryCode:ek.code,country_ids:[ek.code],country_codes:[ek.code],status:"active",originalPlanId:e.id,originalCountry:e.country,attachedAt:new Date,attachedVia:"admin_panel"};e.capacity&&e.period&&(t.capacity=e.capacity,t.period=e.period),await (0,o.gS)((0,o.collection)(c.db,"plans"),t),k.Ay.success('Plan "'.concat(e.name,'" attached to ').concat(ek.name,"!")),eS(!1),e$&&ek&&await e5(ek.code,ek.name),ei&&ed&&await e5(ed.code,ed.name),await e1()}catch(e){console.error("❌ Error attaching plan to country:",e),k.Ay.error("Error attaching plan: ".concat(e.message))}finally{H(!1)}},ac=[{label:"Total Countries",value:ee.length,icon:x.A,color:"blue"},{label:"Regional Plans",value:ex.length,icon:u.A,color:"green"},{label:"Environment",value:O,icon:g.A,color:"gray"},{label:"Status",value:"Active",icon:h.A,color:"emerald"}];return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)("div",{className:"py-8 mb-8 border-b border-gray-200 bg-white/80 backdrop-blur-sm -mx-4 px-4 sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8 sticky top-0 z-10",children:(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2 flex items-center",children:[(0,r.jsx)(g.A,{className:"text-blue-600 mr-3"}),"Admin Panel"]}),(0,r.jsx)("p",{className:"text-gray-600 text-lg",children:"Comprehensive eSIM service management and configuration"})]})})}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-1",children:(0,r.jsx)("nav",{className:"flex space-x-1",children:[{id:"overview",label:"Overview",icon:p.A},{id:"config",label:"Configuration",icon:g.A},{id:"countries",label:"Countries",icon:x.A},{id:"regions",label:"Regional Plans",icon:u.A},{id:"users",label:"Manage Users",icon:y.A}].map(e=>{let a=e.icon;return(0,r.jsxs)("button",{onClick:()=>T(e.id),className:"flex items-center px-6 py-3 rounded-lg font-medium transition-all duration-200 ".concat(L===e.id?"bg-black text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,r.jsx)(a,{className:"w-5 h-5 mr-2"}),e.label]},e.id)})})})}),(0,r.jsx)(d.N,{mode:"wait",children:(0,r.jsxs)(m.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:["overview"===L&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:ac.map((e,a)=>{let t=e.icon;return(0,r.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.label}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value})]}),(0,r.jsx)("div",{className:"p-3 rounded-lg ".concat("blue"===e.color?"bg-blue-100":"green"===e.color?"bg-green-100":"gray"===e.color?"bg-gray-100":"emerald"===e.color?"bg-emerald-100":"bg-gray-100"),children:(0,r.jsx)(t,{className:"w-6 h-6 ".concat("blue"===e.color?"text-blue-600":"green"===e.color?"text-green-600":"gray"===e.color?"text-gray-600":"emerald"===e.color?"text-emerald-600":"text-gray-600")})})]})},e.label)})}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(h.A,{className:"text-blue-600 mr-2"}),"Quick Actions"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>T("config"),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-all duration-200",children:[(0,r.jsx)(g.A,{className:"w-8 h-8 text-blue-600 mb-2"}),(0,r.jsx)("p",{className:"font-medium",children:"Configuration"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Manage API keys and environment"})]}),(0,r.jsxs)("button",{onClick:()=>T("countries"),className:"p-4 border border-gray-200 rounded-lg hover:border-green-300 hover:bg-green-50 transition-all duration-200",children:[(0,r.jsx)(x.A,{className:"w-8 h-8 text-green-600 mb-2"}),(0,r.jsx)("p",{className:"font-medium",children:"Manage Countries"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"View and manage country plans"})]}),(0,r.jsxs)("button",{onClick:()=>T("regions"),className:"p-4 border border-gray-200 rounded-lg hover:border-gray-300 hover:bg-gray-50 transition-all duration-200",children:[(0,r.jsx)(u.A,{className:"w-8 h-8 text-gray-600 mb-2"}),(0,r.jsx)("p",{className:"font-medium",children:"Regional Plans"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Create and manage regional eSIMs"})]})]})]})]}),"config"===L&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(b.A,{className:"text-blue-600 mr-2"}),"DataPlans Environment"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:"Current Mode:"}),(0,r.jsx)("span",{className:"ml-2 px-3 py-1 rounded-full text-sm font-medium ".concat("test"===O?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"test"===O?"Test":"Production"})]}),(0,r.jsx)("button",{onClick:eq,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 bg-gray-200",children:(0,r.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat("production"===O?"translate-x-5":"translate-x-0")})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(f.A,{className:"text-black mr-2"}),"Stripe Payment Mode"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:"Payment Mode:"}),(0,r.jsx)("span",{className:"ml-2 px-3 py-1 rounded-full text-sm font-medium ".concat("test"===z?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"test"===z?"Test":"Production"})]}),(0,r.jsx)("button",{onClick:e0,className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 bg-gray-200",children:(0,r.jsx)("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ".concat("production"===z?"translate-x-5":"translate-x-0")})})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(j.A,{className:"text-green-600 mr-2"}),"DataPlans API Configuration"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:Z?"text":"password",value:$,onChange:e=>V(e.target.value),placeholder:"Enter your DataPlans API key",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("button",{onClick:()=>J(!Z),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:Z?(0,r.jsx)(N.A,{className:"w-5 h-5"}):(0,r.jsx)(v.A,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("button",{onClick:eX,disabled:Y||!$.trim(),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:from-gray-400 disabled:to-gray-500 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center",children:[Y?(0,r.jsx)(w.A,{className:"w-5 h-5 mr-2 animate-spin"}):(0,r.jsx)(j.A,{className:"w-5 h-5 mr-2"}),"Save API Key"]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(w.A,{className:"text-black mr-2"}),"Data Synchronization"]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-blue-900 mb-1 text-sm",children:"Currently Using:"}),(0,r.jsx)("span",{className:"text-sm text-blue-700",children:"test"===O?"https://sandbox.dataplans.io/api/v1":"https://api.dataplans.io/api/v1"})]})})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("button",{onClick:e2,disabled:Y,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center",children:[Y?(0,r.jsx)(w.A,{className:"w-5 h-5 mr-2 animate-spin"}):(0,r.jsx)(A.A,{className:"w-5 h-5 mr-2"}),"Sync All Data from DataPlans API"]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-700 mb-2 text-sm",children:"Sync Status"}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:X})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(P.A,{className:"text-red-600 mr-2"}),"Dangerous Operations"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"These operations are irreversible and will permanently delete data from your database."}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-red-800 mb-2",children:"Delete All Countries & Plans"}),(0,r.jsx)("p",{className:"text-sm text-red-700 mb-3",children:"This will remove ALL countries and their associated plans from the database. DataPlans can then fetch fresh data. This action cannot be undone."}),(0,r.jsxs)("button",{onClick:e4,disabled:Y||K,className:"bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center",children:[K?(0,r.jsx)(m.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 mr-2",children:(0,r.jsx)(C.A,{className:"w-5 h-5"})}):(0,r.jsx)(C.A,{className:"w-5 h-5 mr-2"}),K?"Deleting...":"Delete All Countries & Plans"]})]})})]})]}),"countries"===L&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(S.A,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search countries...",value:es,onChange:e=>en(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsx)("div",{className:"flex space-x-3"})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:et.map((e,a)=>(0,r.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-all duration-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.code})]}),(0,r.jsx)("span",{className:"text-2xl",children:e.flagEmoji||_(e.code)||"\uD83C\uDFF3️"})]}),(0,r.jsx)("div",{className:"space-y-2 mb-4",children:e.hasPlans?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["From $",e.minPrice]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.planCount," plan",1!==e.planCount?"s":""," available"]})]}):(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,r.jsx)("i",{className:"fas fa-info-circle w-4 h-4 inline mr-1"}),"No plans assigned"]})}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>e5(e.code,e.name),className:"flex-1 bg-black hover:bg-gray-800 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors",children:"View Plans"}),(0,r.jsx)("button",{onClick:()=>e6(e.code),className:"bg-red-600 hover:bg-red-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors",children:(0,r.jsx)(C.A,{className:"w-4 h-4"})})]})]},e.id))})]}),"regions"===L&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Regional Plans Management"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Create and manage multi-country eSIM plans"})]}),(0,r.jsxs)("button",{onClick:()=>ew(!0),className:"bg-black hover:bg-gray-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center",children:[(0,r.jsx)(E.A,{className:"w-5 h-5 mr-2"}),"Create Region"]})]})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ex.map((e,a)=>(0,r.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-all duration-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.code})]}),(0,r.jsx)("span",{className:"text-2xl",children:e.icon||"\uD83C\uDF0D"})]}),(0,r.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),e.minPrice?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["From $",e.minPrice]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Plans available"})]}):(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,r.jsx)("i",{className:"fas fa-info-circle w-4 h-4 inline mr-1"}),"No plans assigned"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>e7(e.id,e.name),className:"flex-1 bg-black hover:bg-gray-800 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors",children:"View Plans"}),(0,r.jsx)("button",{onClick:()=>e9(e.id,e.name),className:"bg-red-600 hover:bg-red-700 text-white py-2 px-3 rounded-lg text-sm font-medium transition-colors",children:(0,r.jsx)(C.A,{className:"w-4 h-4"})})]})]},e.id))}),0===ex.length&&(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[(0,r.jsx)(u.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Regional Plans"}),(0,r.jsx)("p",{className:"text-gray-600",children:"No regional plans created yet"})]})]}),"users"===L&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,r.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"User Management"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage users and their permissions"})]})})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(S.A,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search users by email, role, or user ID...",value:eL,onChange:e=>eT(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[eG.length," user",1!==eG.length?"s":""," found"]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:eG.length>0?eG.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.email.charAt(0).toUpperCase()})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.email}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["User ID: ",e.id]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("admin"===e.role||"super_admin"===e.role?"bg-red-100 text-red-800":"moderator"===e.role?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.role||"user"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.createdAt?new Date(e.createdAt.toDate()).toLocaleDateString():"Unknown"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[("admin"===e.role||"super_admin"===e.role)&&(0,r.jsx)("button",{onClick:()=>{eW(e),eB(!0)},className:"text-red-600 hover:text-red-900 bg-red-50 hover:bg-red-100 px-3 py-1 rounded-md text-xs transition-colors",title:"Remove admin privileges",children:"Remove Admin"}),(0,r.jsx)("button",{onClick:()=>al(e.id,e.email),className:"text-red-600 hover:text-red-900 bg-red-50 hover:bg-red-100 px-3 py-1 rounded-md text-xs transition-colors",title:"Delete user",children:"Delete"})]})})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:"5",className:"px-6 py-12 text-center text-gray-500",children:[(0,r.jsx)(y.A,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,r.jsx)("p",{className:"text-sm",children:"No users found"}),eL&&(0,r.jsx)("p",{className:"text-xs mt-1",children:"Try adjusting your search terms"})]})})})]})})})]})]},L)}),ev&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(m.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold",children:"Create New Region"}),(0,r.jsx)("button",{onClick:()=>ew(!1),className:"text-gray-400 hover:text-gray-600",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region Name*"}),(0,r.jsx)("input",{type:"text",value:eU.name,onChange:e=>eI({...eU,name:e.target.value}),placeholder:"e.g., Europe",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region Code*"}),(0,r.jsx)("input",{type:"text",value:eU.code,onChange:e=>eI({...eU,code:e.target.value.toUpperCase()}),placeholder:"e.g., EUR",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{value:eU.description,onChange:e=>eI({...eU,description:e.target.value}),placeholder:"Description of the regional coverage",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Starting Price"}),(0,r.jsx)("input",{type:"number",value:eU.minPrice,onChange:e=>eI({...eU,minPrice:parseFloat(e.target.value)}),placeholder:"0.00",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icon"}),(0,r.jsx)("input",{type:"text",value:eU.icon,onChange:e=>eI({...eU,icon:e.target.value}),placeholder:"\uD83C\uDF0D",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>ew(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:e8,disabled:Y||!eU.name||!eU.code,className:"flex-1 bg-black hover:bg-gray-800 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors",children:Y?"Creating...":"Create Region"})]})]})}),e$&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(m.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[80vh] overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold",children:["Plans for ",eY]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage country eSIM plans"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)("div",{className:"relative dropdown-container",style:{position:"relative",zIndex:9999},children:[(0,r.jsxs)("button",{onClick:async()=>{let e=!eC;eS(e),e&&await ao()},className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center",children:[(0,r.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Attach Plan"]}),eC&&(0,r.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-[9999] overflow-hidden",style:{minWidth:"400px",maxWidth:"90vw",maxHeight:"400px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[(0,r.jsxs)("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:"Select Plan to Attach"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Available plans from DataPlans"})]}),(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:"300px"},children:eE.length>0?(0,r.jsx)("div",{className:"p-2",children:eE.map(e=>(0,r.jsx)("div",{onClick:()=>{ai(e),eS(!1)},className:"p-3 hover:bg-gray-50 rounded-lg cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h5",{className:"font-medium text-gray-900 text-sm truncate",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:[e.data," • ",e.duration]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Country: ",e.country]})]}),(0,r.jsxs)("div",{className:"text-right ml-2 flex-shrink-0",children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-green-600",children:["USD"===e.currency?"$":e.currency,Math.round(e.price)]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.currency})]})]})},e.id))}):(0,r.jsxs)("div",{className:"p-4 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500",children:"No plans available"}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Sync plans from config section first"})]})})]})]}),(0,r.jsx)("button",{onClick:()=>eV(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})]})}),(0,r.jsx)("div",{className:"p-6 overflow-y-auto max-h-96",children:eZ.length>0?(0,r.jsx)("div",{className:"space-y-4",children:eZ.map(e=>(console.log("\uD83D\uDCCB Rendering plan:",e),(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg p-6 hover:border-gray-300 hover:shadow-md transition-all",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),e.source&&(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("mobile"===e.source?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:"mobile"===e.source?"\uD83D\uDCF1 Mobile":"\uD83C\uDF10 Web"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[e.data," • ",e.duration]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Country: ",e.country]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Price"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-black",children:["USD"===e.currency?"$":e.currency,Math.round(e.price)]})]})})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDD27 Edit button clicked for plan:",e);let a=prompt('Edit price for "'.concat(e.name,'"\n\nCurrent price: ').concat("USD"===e.currency?"$":e.currency).concat(Math.round(e.price),"\n\nEnter new price:"),Math.round(e.price));a&&!isNaN(parseFloat(a))&&parseFloat(a)>0?(console.log("\uD83D\uDCB0 Updating price for plan:",e.id,"to:",a),aa(e.id,parseFloat(a))):null!==a&&k.Ay.error("Please enter a valid price")},className:"px-4 py-2 bg-black text-white rounded-lg text-sm hover:bg-gray-800 transition-colors flex items-center",children:[(0,r.jsx)(D.A,{className:"w-4 h-4 mr-1"}),"Edit Price"]}),(0,r.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDDD1️ Delete button clicked for plan:",e),window.confirm('Remove plan "'.concat(e.name,'" from this country?'))&&(console.log("\uD83D\uDDD1️ Deleting plan:",e.id,e.name),ae(e.id,e.name))},className:"px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition-colors flex items-center",children:[(0,r.jsx)(C.A,{className:"w-4 h-4 mr-1"}),"Remove"]})]})]})},e.id)))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(j.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Plans Attached"}),(0,r.jsx)("p",{className:"text-gray-600",children:'This country doesn\'t have any plans yet. Use "Attach Plan" to add plans from DataPlans.'})]})}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["Available Plans: ",eZ.length]}),(0,r.jsxs)("span",{children:["Country: ",eY]})]})})]})}),ep&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(m.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[80vh] overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold",children:["Plans for ",null==eb?void 0:eb.name]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage regional eSIM plans"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)("div",{className:"relative dropdown-container",style:{position:"relative",zIndex:9999},children:[(0,r.jsxs)("button",{onClick:async()=>{let e=!eA;eP(e),e&&await at()},className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center",children:[(0,r.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Attach Plan"]}),eA&&(0,r.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-[9999] overflow-hidden",style:{minWidth:"400px",maxWidth:"90vw",maxHeight:"400px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[(0,r.jsxs)("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:"Select Plan to Attach"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Available plans from DataPlans"})]}),(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:"300px"},children:eE.length>0?(0,r.jsx)("div",{className:"p-2",children:eE.map(e=>(0,r.jsx)("div",{onClick:()=>{ar(e),eP(!1)},className:"p-3 hover:bg-gray-50 rounded-lg cursor-pointer border-b border-gray-100 last:border-b-0 transition-colors",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h5",{className:"font-medium text-gray-900 text-sm truncate",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:[e.data," • ",e.duration]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Country: ",e.country]})]}),(0,r.jsxs)("div",{className:"text-right ml-2 flex-shrink-0",children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-green-600",children:["USD"===e.currency?"$":e.currency,Math.round(e.price)]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.currency})]})]})},e.id))}):(0,r.jsxs)("div",{className:"p-4 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500",children:"No plans available"}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"Sync plans from config section first"})]})})]})]}),(0,r.jsx)("button",{onClick:()=>ey(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})]})}),(0,r.jsx)("div",{className:"p-6 overflow-y-auto max-h-96",children:ej.length>0?(0,r.jsx)("div",{className:"space-y-4",children:ej.map(e=>(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg p-6 hover:border-gray-300 hover:shadow-md transition-all",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:e.name}),e.originalPlanId&&(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:"Attached"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Data"}),(0,r.jsx)("p",{className:"font-medium",children:e.data})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Duration"}),(0,r.jsx)("p",{className:"font-medium",children:e.duration})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Price"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-black",children:["USD"===e.currency?"$":e.currency,Math.round(e.price)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Type"}),(0,r.jsx)("p",{className:"font-medium",children:e.originalPlanId?"Attached":"Custom"})]})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-3",children:e.description})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 ml-4",children:[(0,r.jsxs)("button",{onClick:()=>{let a=prompt('Edit price for "'.concat(e.name,'"\n\nCurrent price: ').concat("USD"===e.currency?"$":e.currency).concat(Math.round(e.price),"\n\nEnter new price:"),Math.round(e.price));a&&!isNaN(parseFloat(a))&&parseFloat(a)>0?aa(e.id,parseFloat(a)):null!==a&&k.Ay.error("Please enter a valid price")},className:"px-4 py-2 bg-black text-white rounded-lg text-sm hover:bg-gray-800 transition-colors flex items-center",children:[(0,r.jsx)(D.A,{className:"w-4 h-4 mr-1"}),"Edit Price"]}),(0,r.jsxs)("button",{onClick:()=>ae(e.id,e.name),className:"px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition-colors flex items-center",children:[(0,r.jsx)(C.A,{className:"w-4 h-4 mr-1"}),e.originalPlanId?"Detach":"Delete"]})]})]})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(u.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Plans Yet"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["No plans attached to ",null==eb?void 0:eb.name]})]})}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,r.jsx)("div",{className:"text-sm text-gray-600 text-center",children:(0,r.jsxs)("span",{children:["Total Plans: ",ej.length]})})})]})}),eO&&ez&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)(m.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-red-600",children:"Remove Admin Privileges"}),(0,r.jsx)("button",{onClick:()=>{eB(!1),eW(null)},className:"text-gray-400 hover:text-gray-600",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(P.A,{className:"w-5 h-5 text-red-600 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Warning"})]}),(0,r.jsxs)("p",{className:"text-sm text-red-700 mt-2",children:["You are about to remove admin privileges from ",(0,r.jsx)("strong",{children:ez.email}),"."]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"What this means:"})}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"User will lose access to admin dashboard"}),(0,r.jsx)("li",{children:"User will become a regular user"}),(0,r.jsx)("li",{children:"This action can be reversed by another admin"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,r.jsx)("button",{onClick:()=>{eB(!1),eW(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>an(ez.id,ez.email),disabled:Y,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 transition-colors",children:Y?"Removing...":"Remove Admin"})]})]})]})})]})})}},5869:(e,a,t)=>{"use strict";t.d(a,{X7:()=>g,z8:()=>u});var r=t(5155),s=t(2115),n=t(6809),l=t(9708),o=t(686);let i={SUPER_ADMIN:"super_admin",ADMIN:"admin",MODERATOR:"moderator",USER:"user"},c={[i.SUPER_ADMIN]:["manage_users","manage_admins","manage_countries","manage_plans","manage_config","view_analytics","delete_data"],[i.ADMIN]:["manage_countries","manage_plans","manage_config","view_analytics"],[i.MODERATOR]:["manage_countries","manage_plans","view_analytics"],[i.USER]:[]};class d{async isAdmin(e){try{let a=await (0,l.getDoc)((0,l.doc)(o.db,"users",e));if(!a.exists())return!1;let t=a.data();return t.role&&t.role!==i.USER}catch(e){return console.error("Error checking admin status:",e),!1}}async getUserRole(e){try{let a=await (0,l.getDoc)((0,l.doc)(o.db,"users",e));if(!a.exists())return i.USER;return a.data().role||i.USER}catch(e){return console.error("Error getting user role:",e),i.USER}}async hasPermission(e,a){try{return(c[await this.getUserRole(e)]||[]).includes(a)}catch(e){return console.error("Error checking permission:",e),!1}}async setUserRole(e,a,t){try{if(!await this.hasPermission(t,"manage_admins"))throw Error("Insufficient permissions to manage admin roles");return await (0,l.mZ)((0,l.doc)(o.db,"users",e),{role:a,roleUpdatedAt:(0,l.O5)(),roleUpdatedBy:t}),await this.logAdminAction(t,"role_change",{targetUserId:e,newRole:a,timestamp:new Date().toISOString()}),{success:!0}}catch(e){throw console.error("Error setting user role:",e),e}}async getAdminUsers(){try{let e=(0,l.P)((0,l.collection)(o.db,"users"),(0,l._M)("role","in",[i.SUPER_ADMIN,i.ADMIN,i.MODERATOR])),a=await (0,l.GG)(e),t=[];return a.forEach(e=>{t.push({id:e.id,...e.data()})}),t}catch(e){return console.error("Error getting admin users:",e),[]}}async getAllUsers(){try{let e=await (0,l.GG)((0,l.collection)(o.db,"users")),a=[];return e.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(e){return console.error("Error getting all users:",e),[]}}async createSuperAdmin(e,a){try{return await (0,l.BN)((0,l.doc)(o.db,"users",e),{email:a,role:i.SUPER_ADMIN,createdAt:(0,l.O5)(),isInitialAdmin:!0},{merge:!0}),{success:!0}}catch(e){throw console.error("Error creating super admin:",e),e}}async logAdminAction(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{await (0,l.BN)((0,l.doc)((0,l.collection)(o.db,"admin_logs")),{adminId:e,action:a,details:t,timestamp:(0,l.O5)(),ip:"unknown",userAgent:navigator.userAgent})}catch(e){console.error("Error logging admin action:",e)}}async getAdminLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{let a=await (0,l.GG)((0,l.P)((0,l.collection)(o.db,"admin_logs"))),t=[];return a.forEach(e=>{t.push({id:e.id,...e.data()})}),t.sort((e,a)=>e.timestamp&&a.timestamp?a.timestamp.toDate()-e.timestamp.toDate():0).slice(0,e)}catch(e){return console.error("Error getting admin logs:",e),[]}}async removeAdminRole(e,a){try{if(!await this.hasPermission(a,"manage_admins"))throw Error("Insufficient permissions to manage admin roles");let t=await this.getUserRole(e);if(t===i.SUPER_ADMIN)throw Error("Cannot remove super admin role");return await (0,l.mZ)((0,l.doc)(o.db,"users",e),{role:i.USER,roleUpdatedAt:(0,l.O5)(),roleUpdatedBy:a}),await this.logAdminAction(a,"role_removed",{targetUserId:e,previousRole:t,timestamp:new Date().toISOString()}),{success:!0}}catch(e){throw console.error("Error removing admin role:",e),e}}}let m=new d,x=(0,s.createContext)(),u=()=>{let e=(0,s.useContext)(x);if(!e)throw Error("useAdmin must be used within an AdminProvider");return e},g=e=>{let{children:a}=e,{currentUser:t}=(0,n.A)(),[l,o]=(0,s.useState)(i.USER),[d,u]=(0,s.useState)(!1),[g,h]=(0,s.useState)([]),[p,y]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{if(!t){o(i.USER),u(!1),h([]),y(!1);return}try{y(!0);let e=await m.getUserRole(t.uid);o(e);let a=e!==i.USER;u(a);let r=c[e]||[];h(r)}catch(e){console.error("Error loading user role:",e),o(i.USER),u(!1),h([])}finally{y(!1)}})()},[t]);let b=e=>g.includes(e),f=async()=>{if(t)try{let e=await m.getUserRole(t.uid);o(e),u(e!==i.USER);let a=c[e]||[];h(a)}catch(e){console.error("Error refreshing user role:",e)}};return(0,r.jsx)(x.Provider,{value:{userRole:l,isAdmin:d,permissions:g,loading:p,hasPermission:b,canManageAdmins:()=>b("manage_admins"),canManageCountries:()=>b("manage_countries"),canManagePlans:()=>b("manage_plans"),canManageConfig:()=>b("manage_config"),canDeleteData:()=>b("delete_data"),canViewAnalytics:()=>b("view_analytics"),refreshRole:f,ADMIN_ROLES:i},children:a})}},6809:(e,a,t)=>{"use strict";t.d(a,{A:()=>c,O:()=>d});var r=t(5155),s=t(2115),n=t(1328),l=t(9708),o=t(686);let i=(0,s.createContext)();function c(){return(0,s.useContext)(i)}function d(e){let{children:a}=e,[t,c]=(0,s.useState)(null),[d,m]=(0,s.useState)(!0),[x,u]=(0,s.useState)(null);async function g(e,a,t){try{let{user:r}=await (0,n.eJ)(o.j2,e,a);return await (0,n.r7)(r,{displayName:t}),await (0,l.BN)((0,l.doc)(o.db,"users",r.uid),{email:r.email,displayName:t,createdAt:new Date,role:"customer",wallet:{balance:0,currency:"USD"}}),r}catch(e){throw e}}async function h(e,a){try{let{user:t}=await (0,n.x9)(o.j2,e,a);return t}catch(e){throw e}}async function p(){try{await (0,n.CI)(o.j2)}catch(e){throw e}}async function y(e){try{await (0,n.J1)(o.j2,e)}catch(e){throw e}}async function b(e){try{t&&(await (0,l.BN)((0,l.doc)(o.db,"users",t.uid),e,{merge:!0}),u(a=>({...a,...e})))}catch(e){throw e}}async function f(){if(t)try{let e=await (0,l.getDoc)((0,l.doc)(o.db,"users",t.uid));e.exists()&&u(e.data())}catch(e){console.error("Error loading user profile:",e)}}return(0,s.useEffect)(()=>(0,n.hg)(o.j2,async e=>{c(e),e?await f():u(null),m(!1)}),[]),(0,r.jsx)(i.Provider,{value:{currentUser:t,userProfile:x,signup:g,login:h,logout:p,resetPassword:y,updateUserProfile:b,loadUserProfile:f},children:!d&&a})}},7506:(e,a,t)=>{Promise.resolve().then(t.bind(t,4156))}},e=>{e.O(0,[135,210,584,416,663,406,441,255,358],()=>e(e.s=7506)),_N_E=e.O()}]);